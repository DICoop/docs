<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.3" xml:lang="ru">
  <compounddef id="registrator_8cpp" kind="file" language="C++">
    <compoundname>registrator.cpp</compoundname>
    <includes refid="registrator_8hpp" local="yes">registrator.hpp</includes>
    <incdepgraph>
      <node id="13">
        <label>../common/accounts.hpp</label>
        <link refid="accounts_8hpp"/>
      </node>
      <node id="21">
        <label>../common/admins.hpp</label>
        <link refid="admins_8hpp"/>
      </node>
      <node id="20">
        <label>../common/balances.hpp</label>
        <link refid="balances_8hpp"/>
      </node>
      <node id="12">
        <label>../common/consts.hpp</label>
        <link refid="consts_8hpp"/>
      </node>
      <node id="15">
        <label>../common/coops.hpp</label>
        <link refid="coops_8hpp"/>
      </node>
      <node id="14">
        <label>../common/drafts.hpp</label>
        <link refid="drafts_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>../common/permissions.hpp</label>
        <link refid="permissions_8hpp"/>
      </node>
      <node id="17">
        <label>../common/rammarket.hpp</label>
        <link refid="rammarket_8hpp"/>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>../common/utils.hpp</label>
        <link refid="utils_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>registrator/registrator.cpp</label>
        <link refid="registrator_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>registrator.hpp</label>
        <link refid="registrator_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
      </node>
      <node id="18">
        <label>algorithm</label>
      </node>
      <node id="19">
        <label>cmath</label>
      </node>
      <node id="3">
        <label>eosio/asset.hpp</label>
      </node>
      <node id="4">
        <label>eosio/contract.hpp</label>
      </node>
      <node id="5">
        <label>eosio/crypto.hpp</label>
      </node>
      <node id="6">
        <label>eosio/eosio.hpp</label>
      </node>
      <node id="7">
        <label>eosio/multi_index.hpp</label>
      </node>
      <node id="8">
        <label>eosio/system.hpp</label>
      </node>
      <node id="9">
        <label>eosio/time.hpp</label>
      </node>
      <node id="11">
        <label>eosio/transaction.hpp</label>
      </node>
    </incdepgraph>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#include<sp/>&quot;<ref refid="registrator_8hpp" kindref="compound">registrator.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal">[[eosio::action]]<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classregistrator_1a23c67801d0d0f374ba1160537ba314fb" kindref="member">registrator::check</ref>(checksum256<sp/>hash,<sp/>public_key<sp/>public_key,<sp/>signature<sp/>signature)</highlight></codeline>
<codeline lineno="4"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5"><highlight class="normal"><sp/><sp/>assert_recover_key(hash,<sp/>signature,<sp/>public_key);</highlight></codeline>
<codeline lineno="6"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal">[[eosio::action]]<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__public__actions_1ga7f70d64012305e3dfca7990bffd3af82" kindref="member">registrator::newaccount</ref>(</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/>eosio::name<sp/><ref refid="classregistrator" kindref="compound">registrator</ref>,<sp/>eosio::name<sp/>coopname,<sp/>eosio::name<sp/>referer,</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/>eosio::name<sp/>username,<sp/>eosio::public_key<sp/>public_key,<sp/>std::string<sp/>meta)</highlight></codeline>
<codeline lineno="25"><highlight class="normal">{</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!has_auth(<ref refid="group__public__consts_1ga1ff8113eaea18bd553df59b9ad7df01a" kindref="member">_provider</ref>))</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="accounts_8hpp_1a368c937be8704a11e240e3751b40d92e" kindref="member">get_cooperative_or_fail</ref>(coopname);</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="admins_8hpp_1a8b2cff2f5076afcf685cdb60a6521702" kindref="member">check_auth_or_fail</ref>(coopname,<sp/><ref refid="classregistrator" kindref="compound">registrator</ref>,<sp/></highlight><highlight class="stringliteral">&quot;newaccount&quot;</highlight><highlight class="normal">_n);</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><ref refid="structauthority" kindref="compound">authority</ref><sp/>active_auth;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/>active_auth.<ref refid="structauthority_1ab9fbc4a419012844e80ffebb57d76971" kindref="member">threshold</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><ref refid="structkey__weight" kindref="compound">key_weight</ref><sp/>keypermission{public_key,<sp/>1};</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/>active_auth.<ref refid="structauthority_1a7538d1edffef8dd8ebe41758fbc4fdd8" kindref="member">keys</ref>.emplace_back(keypermission);</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><ref refid="structauthority" kindref="compound">authority</ref><sp/>owner_auth;</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/>owner_auth.<ref refid="structauthority_1ab9fbc4a419012844e80ffebb57d76971" kindref="member">threshold</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Устанавливаем<sp/>разрешение<sp/>eosio.prods@active<sp/>для<sp/>владельца</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><ref refid="structpermission__level__weight" kindref="compound">permission_level_weight</ref><sp/>eosio_prods_plw{</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/></highlight><highlight class="stringliteral">&quot;active&quot;</highlight><highlight class="normal">_n},</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>1};</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/>owner_auth.<ref refid="structauthority_1a0929cd72740ad0953b59fdc1df188b60" kindref="member">accounts</ref>.push_back(eosio_prods_plw);</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/>eosio::asset<sp/>ram<sp/>=<sp/>asset(<ref refid="namespaceeosiosystem_1a2bf66ae74712f288511596991a953dbf" kindref="member">_ram_price_per_byte</ref><sp/>*<sp/>_ram_bytes_for_new_account,<sp/><ref refid="group__public__consts_1ga6b01540b618a86e6bd5303db76e3b45f" kindref="member">_root_symbol</ref>);</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/>eosio::asset<sp/>cpu<sp/>=<sp/>asset(<ref refid="group__public__consts_1ga835d48268b6c17e01d290de412eb4c81" kindref="member">_stake_cpu_amount</ref>,<sp/><ref refid="group__public__consts_1ga6b01540b618a86e6bd5303db76e3b45f" kindref="member">_root_symbol</ref>);</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/>eosio::asset<sp/>net<sp/>=<sp/>asset(<ref refid="group__public__consts_1gae58ff0a7ec09c8cfd9d7ccd76d5f2c24" kindref="member">_stake_net_amount</ref>,<sp/><ref refid="group__public__consts_1ga6b01540b618a86e6bd5303db76e3b45f" kindref="member">_root_symbol</ref>);</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/>eosio::asset<sp/>total_pay<sp/>=<sp/>cpu<sp/>+<sp/>net<sp/>+<sp/>ram;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/>action(permission_level(<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/></highlight><highlight class="stringliteral">&quot;active&quot;</highlight><highlight class="normal">_n),<sp/></highlight><highlight class="stringliteral">&quot;eosio&quot;</highlight><highlight class="normal">_n,<sp/></highlight><highlight class="stringliteral">&quot;createaccnt&quot;</highlight><highlight class="normal">_n,</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::tuple(username,<sp/>owner_auth,<sp/>active_auth))</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>.send();</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><ref refid="accounts_8hpp_1a8d9239816b55cd7718da56b79346de74" kindref="member">accounts_index</ref><sp/>accounts(<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/><ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>.value);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>card<sp/>=<sp/>accounts.find(username.value);</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/>eosio::check(card<sp/>==<sp/>accounts.end(),<sp/></highlight><highlight class="stringliteral">&quot;Аккаунт<sp/>уже<sp/>зарегистририван&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/>accounts.emplace(<ref refid="classregistrator" kindref="compound">registrator</ref>,<sp/>[&amp;](</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;n)</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/>n.username<sp/>=<sp/>username;</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/>n.status<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;pending&quot;</highlight><highlight class="normal">_n;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/>n.<ref refid="classregistrator_1a5031045fe1736a84cd445be212673c0b" kindref="member">registrator</ref><sp/>=<sp/><ref refid="classregistrator_1a5031045fe1736a84cd445be212673c0b" kindref="member">registrator</ref>;</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/>n.referer<sp/>=<sp/>referer;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/>n.registered_at<sp/>=</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eosio::time_point_sec(eosio::current_time_point().sec_since_epoch());</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/>n.meta<sp/>=<sp/>meta;<sp/>});</highlight></codeline>
<codeline lineno="71"><highlight class="normal">}</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal">[[eosio::action]]<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__public__actions_1ga8f4b3d521cb45d617026964bbc6e302c" kindref="member">registrator::reguser</ref>(eosio::name<sp/><ref refid="classregistrator" kindref="compound">registrator</ref>,<sp/>eosio::name<sp/>coopname,<sp/>eosio::name<sp/>username)</highlight></codeline>
<codeline lineno="87"><highlight class="normal">{</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>cooperative<sp/>=<sp/><ref refid="accounts_8hpp_1a368c937be8704a11e240e3751b40d92e" kindref="member">get_cooperative_or_fail</ref>(coopname);</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><ref refid="admins_8hpp_1a8b2cff2f5076afcf685cdb60a6521702" kindref="member">check_auth_or_fail</ref>(coopname,<sp/><ref refid="classregistrator" kindref="compound">registrator</ref>,<sp/></highlight><highlight class="stringliteral">&quot;regorg&quot;</highlight><highlight class="normal">_n);</highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/>eosio::name<sp/>payer<sp/>=<sp/><ref refid="classregistrator_1a5031045fe1736a84cd445be212673c0b" kindref="member">registrator</ref>;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><ref refid="accounts_8hpp_1a8d9239816b55cd7718da56b79346de74" kindref="member">accounts_index</ref><sp/>accounts(<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/><ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>.value);</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>new_user<sp/>=<sp/>accounts.find(username.value);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/>eosio::check(new_user<sp/>!=<sp/>accounts.end(),<sp/></highlight><highlight class="stringliteral">&quot;Участник<sp/>не<sp/>найден<sp/>в<sp/>картотеке<sp/>аккаунтов&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/>eosio::check(new_user-&gt;type<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">_n,<sp/></highlight><highlight class="stringliteral">&quot;Аккаунт<sp/>уже<sp/>получил<sp/>карточку<sp/>участника,<sp/>повторное<sp/>получение<sp/>невозможно.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/>std::vector&lt;eosio::name&gt;<sp/>storages;</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/>storages.push_back(coopname);</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/>accounts.modify(new_user,<sp/>payer,<sp/>[&amp;](</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;c)</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>c.type<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;user&quot;</highlight><highlight class="normal">_n;</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/>c.storages<sp/>=<sp/>storages;<sp/>});</highlight></codeline>
<codeline lineno="106"><highlight class="normal">}</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal">[[eosio::action]]<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classregistrator_1a640dbd37c2d97cc93ff00ec0dc4116be" kindref="member">registrator::init</ref>()</highlight></codeline>
<codeline lineno="109"><highlight class="normal">{</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/>require_auth(<ref refid="group__public__consts_1ga52724c95f23545d7efc4db16f3fe42ce" kindref="member">_system</ref>);</highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><ref refid="accounts_8hpp_1a8d9239816b55cd7718da56b79346de74" kindref="member">accounts_index</ref><sp/>accounts(<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/><ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>.value);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/><ref refid="structaccount" kindref="compound">account</ref><sp/>=<sp/>accounts.find(<ref refid="group__public__consts_1ga1ff8113eaea18bd553df59b9ad7df01a" kindref="member">_provider</ref>.value);</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/>eosio::check(<ref refid="structaccount" kindref="compound">account</ref><sp/>==<sp/>accounts.end(),<sp/></highlight><highlight class="stringliteral">&quot;Контракт<sp/>регистратора<sp/>уже<sp/>инициализирован<sp/>для<sp/>указанного<sp/>провайдера&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/>std::vector&lt;eosio::name&gt;<sp/>storages;</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/>storages.push_back(<ref refid="group__public__consts_1ga1ff8113eaea18bd553df59b9ad7df01a" kindref="member">_provider</ref>);</highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/>accounts.emplace(<ref refid="group__public__consts_1ga52724c95f23545d7efc4db16f3fe42ce" kindref="member">_system</ref>,<sp/>[&amp;](</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;n)</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/>n.type<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;user&quot;</highlight><highlight class="normal">_n;</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/>n.storages<sp/>=<sp/>storages;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>n.username<sp/>=<sp/><ref refid="group__public__consts_1ga42013fa54096a8d11445a6006eaa0771" kindref="member">_provider_chairman</ref>;</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/>n.status<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;active&quot;</highlight><highlight class="normal">_n;</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/>n.registrator<sp/>=<sp/><ref refid="group__public__consts_1ga52724c95f23545d7efc4db16f3fe42ce" kindref="member">_system</ref>;</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/>n.referer<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">_n;</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/>n.registered_at<sp/>=</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eosio::time_point_sec(eosio::current_time_point().sec_since_epoch());<sp/>});</highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/>accounts.emplace(<ref refid="group__public__consts_1ga52724c95f23545d7efc4db16f3fe42ce" kindref="member">_system</ref>,<sp/>[&amp;](</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;n)</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/>n.type<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;org&quot;</highlight><highlight class="normal">_n;</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/>n.storages<sp/>=<sp/>storages;</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/>n.username<sp/>=<sp/><ref refid="group__public__consts_1ga1ff8113eaea18bd553df59b9ad7df01a" kindref="member">_provider</ref>;</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/>n.status<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;active&quot;</highlight><highlight class="normal">_n;</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>n.registrator<sp/>=<sp/><ref refid="group__public__consts_1ga52724c95f23545d7efc4db16f3fe42ce" kindref="member">_system</ref>;</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/>n.referer<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">_n;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/>n.registered_at<sp/>=</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eosio::time_point_sec(eosio::current_time_point().sec_since_epoch());<sp/>});</highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><ref refid="accounts_8hpp_1a216c9600f34a4338ccb257aeba1bd763" kindref="member">organizations_index</ref><sp/>orgs(<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/><ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>.value);</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/>eosio::check(<ref refid="group__public__consts_1ga3a2b682d2d7616aee19abf3001792595" kindref="member">_provider_initial</ref>.symbol<sp/>==<sp/><ref refid="group__public__consts_1gacf903cac90cfb816da7c0498d6ba77db" kindref="member">_provider_minimum</ref>.symbol<sp/>&amp;&amp;<sp/><ref refid="group__public__consts_1gacf903cac90cfb816da7c0498d6ba77db" kindref="member">_provider_minimum</ref>.symbol<sp/>==<sp/><ref refid="group__public__consts_1ga5c15ddd21a87c0b286a24580936dc4b7" kindref="member">_root_govern_symbol</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Неверные<sp/>символы<sp/>для<sp/>взносов&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/>orgs.emplace(<ref refid="group__public__consts_1ga52724c95f23545d7efc4db16f3fe42ce" kindref="member">_system</ref>,<sp/>[&amp;](</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;org)</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/>org.username<sp/>=<sp/><ref refid="group__public__consts_1ga1ff8113eaea18bd553df59b9ad7df01a" kindref="member">_provider</ref>;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>org.is_cooperative<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/>org.coop_type<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;conscoop&quot;</highlight><highlight class="normal">_n;</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/>org.initial<sp/>=<sp/><ref refid="group__public__consts_1ga3a2b682d2d7616aee19abf3001792595" kindref="member">_provider_initial</ref>;</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>org.minimum<sp/>=<sp/><ref refid="group__public__consts_1gacf903cac90cfb816da7c0498d6ba77db" kindref="member">_provider_minimum</ref>;</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/>org.registration<sp/>=<sp/><ref refid="group__public__consts_1ga3a2b682d2d7616aee19abf3001792595" kindref="member">_provider_initial</ref><sp/>+<sp/><ref refid="group__public__consts_1gacf903cac90cfb816da7c0498d6ba77db" kindref="member">_provider_minimum</ref>;<sp/>});</highlight></codeline>
<codeline lineno="152"><highlight class="normal">};</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal">[[eosio::action]]<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__public__actions_1ga4354646d3bbc28e76659cc650d2011ec" kindref="member">registrator::regorg</ref>(eosio::name<sp/><ref refid="classregistrator" kindref="compound">registrator</ref>,<sp/>eosio::name<sp/>coopname,<sp/>eosio::name<sp/>username,<sp/><ref refid="structorg__data" kindref="compound">org_data</ref><sp/>params)</highlight></codeline>
<codeline lineno="164"><highlight class="normal">{</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><ref refid="admins_8hpp_1a8b2cff2f5076afcf685cdb60a6521702" kindref="member">check_auth_or_fail</ref>(coopname,<sp/><ref refid="classregistrator" kindref="compound">registrator</ref>,<sp/></highlight><highlight class="stringliteral">&quot;regorg&quot;</highlight><highlight class="normal">_n);</highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/>eosio::name<sp/>payer<sp/>=<sp/><ref refid="classregistrator_1a5031045fe1736a84cd445be212673c0b" kindref="member">registrator</ref>;</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><ref refid="accounts_8hpp_1a368c937be8704a11e240e3751b40d92e" kindref="member">get_cooperative_or_fail</ref>(coopname);</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><ref refid="accounts_8hpp_1a8d9239816b55cd7718da56b79346de74" kindref="member">accounts_index</ref><sp/>accounts(<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/><ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>.value);</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/><ref refid="structaccount" kindref="compound">account</ref><sp/>=<sp/>accounts.find(username.value);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/>eosio::check(<ref refid="structaccount" kindref="compound">account</ref><sp/>!=<sp/>accounts.end(),<sp/></highlight><highlight class="stringliteral">&quot;Участник<sp/>не<sp/>найден<sp/>в<sp/>картотеке<sp/>аккаунтов&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/>eosio::check(<ref refid="structaccount" kindref="compound">account</ref>-&gt;<ref refid="structaccount_1a2e46c559f699df03e1820bf710e778fd" kindref="member">type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">_n,<sp/></highlight><highlight class="stringliteral">&quot;Аккаунт<sp/>уже<sp/>получил<sp/>карточку<sp/>участника,<sp/>повторное<sp/>получение<sp/>невозможно.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/>std::vector&lt;eosio::name&gt;<sp/>storages;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/>storages.push_back(coopname);</highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/>accounts.modify(<ref refid="structaccount" kindref="compound">account</ref>,<sp/>payer,<sp/>[&amp;](</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;c)</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>c.<ref refid="structaccount_1a2e46c559f699df03e1820bf710e778fd" kindref="member">type</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;org&quot;</highlight><highlight class="normal">_n;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>c.storages<sp/>=<sp/>storages;<sp/>});</highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><ref refid="accounts_8hpp_1a216c9600f34a4338ccb257aeba1bd763" kindref="member">organizations_index</ref><sp/>orgs(<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/><ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>.value);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/>eosio::check(params.<ref refid="structorg__data_1a46f196bb722c9e9218cb972193a676ff" kindref="member">initial</ref>.symbol<sp/>==<sp/>params.<ref refid="structorg__data_1a0e181c3124d29937b16b0bef4b2bdafa" kindref="member">minimum</ref>.symbol,<sp/></highlight><highlight class="stringliteral">&quot;Неверные<sp/>символы<sp/>для<sp/>взносов&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="187"><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>проверить<sp/>поля,<sp/>если<sp/>это<sp/>кооператив</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/>orgs.emplace(payer,<sp/>[&amp;](</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;org)</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.username<sp/>=<sp/>username;</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.is_cooperative<sp/>=<sp/>params.<ref refid="structorg__data_1a73a9e2d8573545f8852ff0dda1c860e5" kindref="member">is_cooperative</ref>;</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.coop_type<sp/>=<sp/>params.<ref refid="structorg__data_1a879607268d761ab2fb337ac067234678" kindref="member">coop_type</ref>;</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.announce<sp/>=<sp/>params.<ref refid="structorg__data_1af31eb176481e60108b902def456ff225" kindref="member">announce</ref>;</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.description<sp/>=<sp/>params.<ref refid="structorg__data_1a53f757c92b8548c72cb7edc7bb97663a" kindref="member">description</ref>;</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.registration<sp/>=<sp/>params.<ref refid="structorg__data_1a46f196bb722c9e9218cb972193a676ff" kindref="member">initial</ref><sp/>+<sp/>params.<ref refid="structorg__data_1a0e181c3124d29937b16b0bef4b2bdafa" kindref="member">minimum</ref>;</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.initial<sp/>=<sp/>params.<ref refid="structorg__data_1a46f196bb722c9e9218cb972193a676ff" kindref="member">initial</ref>;</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.minimum<sp/>=<sp/>params.<ref refid="structorg__data_1a0e181c3124d29937b16b0bef4b2bdafa" kindref="member">minimum</ref>;<sp/>});</highlight></codeline>
<codeline lineno="201"><highlight class="normal">}</highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal">[[eosio::action]]<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__public__actions_1ga4a1b949ebea1e7cc5c0929e85d184038" kindref="member">registrator::regdepartmnt</ref>(eosio::name<sp/><ref refid="classregistrator" kindref="compound">registrator</ref>,<sp/>eosio::name<sp/>coopname,<sp/>eosio::name<sp/>username,<sp/><ref refid="structplot__data" kindref="compound">plot_data</ref><sp/>params)</highlight></codeline>
<codeline lineno="215"><highlight class="normal">{</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><ref refid="admins_8hpp_1a8b2cff2f5076afcf685cdb60a6521702" kindref="member">check_auth_or_fail</ref>(coopname,<sp/><ref refid="classregistrator" kindref="compound">registrator</ref>,<sp/></highlight><highlight class="stringliteral">&quot;regdepartmnt&quot;</highlight><highlight class="normal">_n);</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/>eosio::name<sp/>payer<sp/>=<sp/>coopname;</highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><ref refid="accounts_8hpp_1a8d9239816b55cd7718da56b79346de74" kindref="member">accounts_index</ref><sp/>accounts(<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/><ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>.value);</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>new_plot_account<sp/>=<sp/>accounts.find(username.value);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/>eosio::check(new_plot_account<sp/>!=<sp/>accounts.end(),<sp/></highlight><highlight class="stringliteral">&quot;Участник<sp/>не<sp/>найден<sp/>в<sp/>картотеке<sp/>аккаунтов&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/>eosio::check(new_plot_account-&gt;type<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">_n,<sp/></highlight><highlight class="stringliteral">&quot;Только<sp/>новый<sp/>аккаунт<sp/>может<sp/>быть<sp/>использован<sp/>для<sp/>создания<sp/>участка&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="223"><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/>accounts.modify(new_plot_account,<sp/>payer,<sp/>[&amp;](</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;c)</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>c.type<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;org&quot;</highlight><highlight class="normal">_n;</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>c.status<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;active&quot;</highlight><highlight class="normal">_n;<sp/>});</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><ref refid="accounts_8hpp_1a216c9600f34a4338ccb257aeba1bd763" kindref="member">organizations_index</ref><sp/>orgs(<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/><ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>.value);</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>parent_org<sp/>=<sp/>orgs.find(coopname.value);</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/>eosio::check(parent_org<sp/>==<sp/>orgs.end(),<sp/></highlight><highlight class="stringliteral">&quot;Организация<sp/>не<sp/>найдена&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>проверить<sp/>поля,<sp/>если<sp/>это<sp/>кооператив</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/>orgs.emplace(payer,<sp/>[&amp;](</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;org)</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.username<sp/>=<sp/>username;</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.parent_username<sp/>=<sp/>coopname;</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.is_cooperative<sp/>=<sp/>parent_org<sp/>-&gt;<sp/>is_cooperative;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.coop_type<sp/>=<sp/>parent_org<sp/>-&gt;<sp/>coop_type;</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.announce<sp/>=<sp/>params.<ref refid="structplot__data_1a5fb18fab386662439ed945d5a2ef73bb" kindref="member">announce</ref>;</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.description<sp/>=<sp/>params.<ref refid="structplot__data_1abd7a5526c0912ce5e7be26ec188a2b0d" kindref="member">description</ref>;</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.initial<sp/>=<sp/>asset(0,<sp/>parent_org<sp/>-&gt;<sp/>initial.symbol);</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>org.minimum<sp/>=<sp/>asset(0,<sp/>parent_org<sp/>-&gt;<sp/>minimum.symbol);<sp/>});</highlight></codeline>
<codeline lineno="246"><highlight class="normal">}</highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal">[[eosio::action]]<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__public__actions_1ga4edb42d418f1b8d0a7ec00f06b9927ae" kindref="member">registrator::verificate</ref>(eosio::name<sp/>username,<sp/>eosio::name<sp/>procedure)</highlight></codeline>
<codeline lineno="260"><highlight class="normal">{</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/>require_auth(<ref refid="group__public__consts_1ga1ff8113eaea18bd553df59b9ad7df01a" kindref="member">_provider</ref>);</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/>eosio::check(procedure<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;online&quot;</highlight><highlight class="normal">_n,<sp/></highlight><highlight class="stringliteral">&quot;Только<sp/>онлайн-верификация<sp/>доступна<sp/>сейчас&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><ref refid="accounts_8hpp_1a8d9239816b55cd7718da56b79346de74" kindref="member">accounts_index</ref><sp/>accounts(<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/><ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>.value);</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/><ref refid="structaccount" kindref="compound">account</ref><sp/>=<sp/>accounts.find(username.value);</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/>eosio::check(<ref refid="structaccount" kindref="compound">account</ref><sp/>!=<sp/>accounts.end(),<sp/></highlight><highlight class="stringliteral">&quot;Аккаунт<sp/>не<sp/>найден&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(procedure<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;online&quot;</highlight><highlight class="normal">_n)</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/>accounts.modify(<ref refid="structaccount" kindref="compound">account</ref>,<sp/><ref refid="group__public__consts_1ga1ff8113eaea18bd553df59b9ad7df01a" kindref="member">_provider</ref>,<sp/>[&amp;](</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;a)</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal">&amp;<sp/>ver<sp/>:<sp/>a.verifications)<sp/>{</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eosio::check(ver.procedure<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;online&quot;</highlight><highlight class="normal">_n,<sp/></highlight><highlight class="stringliteral">&quot;Онлайн<sp/>верификация<sp/>уже<sp/>проведена&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO<sp/>активация/деактивация<sp/>кооператива<sp/>у<sp/>провайдера<sp/>по<sp/>членскому<sp/>взносу</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>a.status<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;active&quot;</highlight><highlight class="normal">_n;</highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structverification" kindref="compound">verification</ref><sp/>new_verification<sp/>{</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.verificator<sp/>=<sp/>_ano,</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.is_verified<sp/>=<sp/>true,</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.procedure<sp/>=<sp/>procedure,</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.created_at<sp/>=<sp/>eosio::time_point_sec(eosio::current_time_point().sec_since_epoch()),</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.last_update<sp/>=<sp/>eosio::time_point_sec(eosio::current_time_point().sec_since_epoch()),</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.notice<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>a.verifications.push_back(new_verification);<sp/>});</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/>eosio::check(</highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Только<sp/>онлайн-верификация<sp/>доступна<sp/>сейчас&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="295"><highlight class="normal">}</highlight></codeline>
<codeline lineno="296"><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal">[[eosio::action]]<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__public__actions_1ga369a1d99c79f0429f2d1f7182382dcd8" kindref="member">registrator::joincoop</ref>(eosio::name<sp/><ref refid="classregistrator" kindref="compound">registrator</ref>,<sp/>eosio::name<sp/>coopname,<sp/>eosio::name<sp/>username,<sp/><ref refid="structdocument" kindref="compound">document</ref><sp/><ref refid="structdocument" kindref="compound">document</ref>)</highlight></codeline>
<codeline lineno="322"><highlight class="normal">{</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><ref refid="admins_8hpp_1a8b2cff2f5076afcf685cdb60a6521702" kindref="member">check_auth_or_fail</ref>(coopname,<sp/><ref refid="classregistrator" kindref="compound">registrator</ref>,<sp/></highlight><highlight class="stringliteral">&quot;joincoop&quot;</highlight><highlight class="normal">_n);</highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>cooperative<sp/>=<sp/><ref refid="accounts_8hpp_1a368c937be8704a11e240e3751b40d92e" kindref="member">get_cooperative_or_fail</ref>(coopname);</highlight></codeline>
<codeline lineno="326"><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Проверяем<sp/>подпись<sp/>документа</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><ref refid="drafts_8hpp_1a51dcf5aff7c16f157d08dc80f2176efa" kindref="member">verify_document_or_fail</ref>(<ref refid="structdocument" kindref="compound">document</ref>);</highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><ref refid="coops_8hpp_1adf0a04dfbe948cdf1bd01cf5b344af61" kindref="member">participants_index</ref><sp/><ref refid="structparticipants" kindref="compound">participants</ref>(<ref refid="group__public__consts_1gaf3f1171b99c198fbeb3ab6a3d8c091d9" kindref="member">_soviet</ref>,<sp/>coopname.value);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>participant<sp/>=<sp/><ref refid="structparticipants" kindref="compound">participants</ref>.find(username.value);</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/>eosio::check(participant<sp/>==<sp/><ref refid="structparticipants" kindref="compound">participants</ref>.end(),<sp/></highlight><highlight class="stringliteral">&quot;Участник<sp/>уже<sp/>является<sp/>членом<sp/>кооператива&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/>action(permission_level{<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/></highlight><highlight class="stringliteral">&quot;active&quot;</highlight><highlight class="normal">_n},<sp/><ref refid="group__public__consts_1gaf3f1171b99c198fbeb3ab6a3d8c091d9" kindref="member">_soviet</ref>,<sp/></highlight><highlight class="stringliteral">&quot;joincoop&quot;</highlight><highlight class="normal">_n,</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::make_tuple(coopname,<sp/>username,<sp/><ref refid="structdocument" kindref="compound">document</ref>))</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>.send();</highlight></codeline>
<codeline lineno="337"><highlight class="normal">};</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal">[[eosio::action]]<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__public__actions_1gac68fe89b4be51de18ac5b5921ca56eed" kindref="member">registrator::update</ref>(eosio::name<sp/>username,</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::string<sp/>meta)</highlight></codeline>
<codeline lineno="353"><highlight class="normal">{</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/>require_auth(username);</highlight></codeline>
<codeline lineno="355"><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><ref refid="accounts_8hpp_1a8d9239816b55cd7718da56b79346de74" kindref="member">accounts_index</ref><sp/>accounts(<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/><ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>.value);</highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/><ref refid="structaccount" kindref="compound">account</ref><sp/>=<sp/>accounts.find(username.value);</highlight></codeline>
<codeline lineno="359"><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/>eosio::check(<ref refid="structaccount" kindref="compound">account</ref><sp/>!=<sp/>accounts.end(),<sp/></highlight><highlight class="stringliteral">&quot;Аккаунт<sp/>не<sp/>зарегистрирован&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/>accounts.modify(<ref refid="structaccount" kindref="compound">account</ref>,<sp/>username,<sp/>[&amp;](</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;acc)</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/>acc.<ref refid="structaccount_1ac0580323930615035d7abe2e6cef4d1e" kindref="member">meta</ref><sp/>=<sp/>meta;<sp/>});</highlight></codeline>
<codeline lineno="364"><highlight class="normal">}</highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal">[[eosio::action]]<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__public__actions_1ga68df314fe90a719f00f0931c097bc6c5" kindref="member">registrator::changekey</ref>(eosio::name<sp/>username,</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eosio::public_key<sp/>public_key)</highlight></codeline>
<codeline lineno="380"><highlight class="normal">{</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/>require_auth(<ref refid="group__public__consts_1ga52724c95f23545d7efc4db16f3fe42ce" kindref="member">_system</ref>);</highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><ref refid="accounts_8hpp_1a8d9239816b55cd7718da56b79346de74" kindref="member">accounts_index</ref><sp/>accounts(<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/><ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>.value);</highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>card<sp/>=<sp/>accounts.find(username.value);</highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(card<sp/>!=<sp/>accounts.end())</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structauthority" kindref="compound">authority</ref><sp/>active_auth;</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/>active_auth.<ref refid="structauthority_1ab9fbc4a419012844e80ffebb57d76971" kindref="member">threshold</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structkey__weight" kindref="compound">key_weight</ref><sp/>keypermission{public_key,<sp/>1};</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/>active_auth.<ref refid="structauthority_1a7538d1edffef8dd8ebe41758fbc4fdd8" kindref="member">keys</ref>.emplace_back(keypermission);</highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Change<sp/>active<sp/>authority<sp/>of<sp/>card<sp/>to<sp/>a<sp/>new<sp/>key</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/>eosio::action(eosio::permission_level(card-&gt;username,<sp/>eosio::name(</highlight><highlight class="stringliteral">&quot;owner&quot;</highlight><highlight class="normal">)),</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eosio::name(</highlight><highlight class="stringliteral">&quot;eosio&quot;</highlight><highlight class="normal">),<sp/>eosio::name(</highlight><highlight class="stringliteral">&quot;updateauth&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::tuple(card-&gt;username,<sp/>eosio::name(</highlight><highlight class="stringliteral">&quot;active&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eosio::name(</highlight><highlight class="stringliteral">&quot;owner&quot;</highlight><highlight class="normal">),<sp/>active_auth))</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.send();</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="401"><highlight class="normal">}</highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal">[[eosio::action]]<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__public__actions_1ga25e4c5c4eea2a2e1463ce911b61117aa" kindref="member">registrator::confirmreg</ref>(eosio::name<sp/>coopname,<sp/>eosio::name<sp/>member)</highlight></codeline>
<codeline lineno="418"><highlight class="normal">{</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/>require_auth(<ref refid="group__public__consts_1gaf3f1171b99c198fbeb3ab6a3d8c091d9" kindref="member">_soviet</ref>);</highlight></codeline>
<codeline lineno="420"><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><ref refid="accounts_8hpp_1a8d9239816b55cd7718da56b79346de74" kindref="member">accounts_index</ref><sp/>accounts(<ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>,<sp/><ref refid="group__public__consts_1gae4d59ec28af0642e3072dd36dd0a537b" kindref="member">_registrator</ref>.value);</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/><ref refid="structaccount" kindref="compound">account</ref><sp/>=<sp/>accounts.find(member.value);</highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/>eosio::check(<ref refid="structaccount" kindref="compound">account</ref><sp/>!=<sp/>accounts.end(),<sp/></highlight><highlight class="stringliteral">&quot;Аккаунт<sp/>не<sp/>найден<sp/>в<sp/>картотеке&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="425"><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/>accounts.modify(<ref refid="structaccount" kindref="compound">account</ref>,<sp/><ref refid="group__public__consts_1gaf3f1171b99c198fbeb3ab6a3d8c091d9" kindref="member">_soviet</ref>,<sp/>[&amp;](</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;g)</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/>g.status<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;active&quot;</highlight><highlight class="normal">_n;<sp/>});</highlight></codeline>
<codeline lineno="428"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="registrator/registrator.cpp"/>
  </compounddef>
</doxygen>
